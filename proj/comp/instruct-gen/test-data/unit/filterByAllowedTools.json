{
  "cases": [
    {
      "name": "filters single tool from Actions section",
      "input": {
        "markdown": "# Header\n\n## Actions\n\n### `write_file`\nWrite files\n\n### `read_file`\nRead files\n\n## Other Section\nKeep this",
        "allowedTools": [
          "write_file"
        ]
      },
      "expected": "# Header\n\n## Actions\n\n### `write_file`\nWrite files\n\n## Other Section\nKeep this"
    },
    {
      "name": "preserves content outside Actions section",
      "input": {
        "markdown": "# Header\nIntro text\n\n## Actions\n\n### `write_file`\nWrite\n\n## Other Section\nMore content\n\n## Final Section\nEnd",
        "allowedTools": []
      },
      "expected": "# Header\nIntro text\n\n## Actions\n\n## Other Section\nMore content\n\n## Final Section\nEnd"
    },
    {
      "name": "handles multi-line tool descriptions",
      "input": {
        "markdown": "## Actions\n\n### `write_file`\nCreate/overwrite file\n```sh nesl\n#!nesl\naction = \"write_file\"\n#!end\n```\n\n### `read_file`\nRead file\n```sh nesl\n#!nesl\naction = \"read_file\"\n#!end\n```\n\n## Other",
        "allowedTools": [
          "read_file"
        ]
      },
      "expected": "## Actions\n\n### `read_file`\nRead file\n```sh nesl\n#!nesl\naction = \"read_file\"\n#!end\n```\n\n## Other"
    },
    {
      "name": "preserves Actions header when no tools allowed",
      "input": {
        "markdown": "## Actions\n\n### `write_file`\nWrite\n\n### `read_file`\nRead",
        "allowedTools": []
      },
      "expected": "## Actions\n"
    },
    {
      "name": "handles tools not in markdown",
      "input": {
        "markdown": "## Actions\n\n### `write_file`\nWrite",
        "allowedTools": [
          "write_file",
          "delete_file",
          "exec"
        ]
      },
      "expected": "## Actions\n\n### `write_file`\nWrite"
    }
  ]
}